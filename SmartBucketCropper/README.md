# SmartBucketCropper ğŸ–¼ï¸

æ™ºèƒ½å›¾ç‰‡åˆ†æ¡¶è£å‰ªå·¥å…· - ä¸ºæ·±åº¦å­¦ä¹ è®­ç»ƒæ•°æ®é›†ä¼˜åŒ–

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ§  **æ™ºèƒ½åˆ†æ¡¶**: ä½¿ç”¨ K-Means ç®—æ³•è‡ªåŠ¨åˆ†æå›¾ç‰‡å°ºå¯¸ï¼Œç”Ÿæˆ 3 ä¸ªæ¨èæ¡¶
- ğŸ“ **64px å¯¹é½**: æ‰€æœ‰å°ºå¯¸è‡ªåŠ¨å¯¹é½åˆ° 64 çš„å€æ•°ï¼Œä¼˜åŒ– GPU æ˜¾å­˜æ•ˆç‡
- âœ‚ï¸ **äº¤äº’å¼è£å‰ª**: é”å®šç›®æ ‡å®½é«˜æ¯”çš„è£å‰ªæ¡†ï¼Œæ‹–æ‹½è°ƒæ•´è£å‰ªèŒƒå›´
- ğŸš€ **æ‰¹é‡å¯¼å‡º**: ä½¿ç”¨ LANCZOS ç®—æ³•é«˜è´¨é‡ç¼©æ”¾ï¼Œè‡ªåŠ¨å¤„ç†æ ‡ç­¾æ–‡ä»¶
- ğŸŒ™ **æš—è‰²ä¸»é¢˜**: æå®¢é£æ ¼çš„ UI è®¾è®¡

## æŠ€æœ¯æ ˆ

- **å‰ç«¯**: React + Vite + Tailwind CSS + react-easy-crop + Zustand
- **åç«¯**: Python FastAPI + Scikit-learn (K-Means) + Pillow

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…åç«¯ä¾èµ–

```bash
cd SmartBucketCropper/backend
pip install -r requirements.txt
```

### 2. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd SmartBucketCropper/backend
python main.py
```

åç«¯å°†åœ¨ http://localhost:8000 å¯åŠ¨ï¼ŒAPI æ–‡æ¡£åœ°å€: http://localhost:8000/docs

### 3. å®‰è£…å‰ç«¯ä¾èµ–

```bash
cd SmartBucketCropper/frontend
npm install
```

### 4. å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨

```bash
cd SmartBucketCropper/frontend
npm run dev
```

å‰ç«¯å°†åœ¨ http://localhost:5173 å¯åŠ¨

## ä½¿ç”¨æµç¨‹

1. **é€‰æ‹©æ–‡ä»¶å¤¹**: è¾“å…¥åŒ…å«è®­ç»ƒå›¾ç‰‡çš„æ–‡ä»¶å¤¹è·¯å¾„
2. **æ™ºèƒ½åˆ†æ¡¶**: ç³»ç»Ÿè‡ªåŠ¨åˆ†æå›¾ç‰‡å°ºå¯¸ï¼Œç”Ÿæˆ 3 ä¸ªæ¨èæ¡¶ï¼ˆå°ºå¯¸å·²å¯¹é½åˆ° 64 å€æ•°ï¼‰
3. **è£å‰ªå›¾ç‰‡**: åœ¨å„ä¸ªæ¡¶ä¸­ç‚¹å‡»å›¾ç‰‡è¿›è¡Œè£å‰ªï¼Œè£å‰ªæ¡†é”å®šç›®æ ‡å®½é«˜æ¯”
4. **æ‰¹é‡å¯¼å‡º**: ç‚¹å‡»å¯¼å‡ºæŒ‰é’®ï¼Œç³»ç»Ÿä¼šä½¿ç”¨ LANCZOS ç®—æ³•å¤„ç†æ‰€æœ‰å·²è£å‰ªçš„å›¾ç‰‡

## æ ¸å¿ƒç®—æ³•

### K-Means åˆ†æ¡¶ + 64 å¯¹é½

```python
def snap_to_64(value):
    """å››èˆäº”å…¥åˆ°æœ€è¿‘çš„ 64 å€æ•°"""
    return round(value / 64) * 64

# K-Means èšç±»åï¼Œå¯¹ä¸­å¿ƒç‚¹è¿›è¡Œå¯¹é½
# ä¾‹å¦‚: 1000x1000 -> 1024x1024
# ä¾‹å¦‚: 500x750 -> 512x768
```

## æ”¯æŒçš„å›¾ç‰‡æ ¼å¼

- JPG / JPEG
- PNG
- WEBP
- BMP
- TIFF
- GIF

## æ ‡ç­¾æ–‡ä»¶å¤„ç†

ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«å¹¶å¤åˆ¶ä¸å›¾ç‰‡åŒåçš„æ ‡ç­¾æ–‡ä»¶:
- `.txt`
- `.json`
- `.caption`
- `.tags`

## é¡¹ç›®ç»“æ„

```
SmartBucketCropper/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ main.py                 # FastAPI ä¸»å…¥å£
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ scan.py            # æ‰«æ API
â”‚   â”‚   â””â”€â”€ export.py          # å¯¼å‡º API
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ bucket_analyzer.py # K-Means åˆ†æ¡¶ç®—æ³•
â”‚   â”‚   â””â”€â”€ image_processor.py # å›¾åƒå¤„ç†
â”‚   â””â”€â”€ requirements.txt
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/        # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ hooks/             # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ api/               # API å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ App.jsx            # ä¸»åº”ç”¨
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.js
â”‚
â””â”€â”€ README.md
```

## License

MIT
